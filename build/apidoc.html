<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/harthur/brain"

    >brain (v0.7.0)</a>
</h1>
<h4>Neural network library</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain">module brain</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.adjustWeights">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.adjustWeights
            <span class="apidocSignatureSpan">(learningRate)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.calculateDeltas">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.calculateDeltas
            <span class="apidocSignatureSpan">(target)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.createTrainStream">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.createTrainStream
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.formatData">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.formatData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.fromJSON">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.fromJSON
            <span class="apidocSignatureSpan">(json)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.initialize">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.initialize
            <span class="apidocSignatureSpan">(sizes)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.run">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.run
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.runInput">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.runInput
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.test">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.test
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.toFunction">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.toFunction
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.toJSON">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.toJSON
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.train">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.train
            <span class="apidocSignatureSpan">(data, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.trainPattern">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.trainPattern
            <span class="apidocSignatureSpan">(input, target, learningRate)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.crossValidate">
            function <span class="apidocSignatureSpan">brain.</span>crossValidate
            <span class="apidocSignatureSpan">(classifierConst, data, opts, trainOpts, k)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">brain.</span>lookup</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">brain.</span>neuralnetwork</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork">module brain.NeuralNetwork</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.NeuralNetwork">
            function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype">module brain.NeuralNetwork.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.adjustWeights">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>adjustWeights
            <span class="apidocSignatureSpan">(learningRate)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.calculateDeltas">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>calculateDeltas
            <span class="apidocSignatureSpan">(target)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.createTrainStream">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>createTrainStream
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.formatData">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>formatData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.fromJSON">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>fromJSON
            <span class="apidocSignatureSpan">(json)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.initialize">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>initialize
            <span class="apidocSignatureSpan">(sizes)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.run">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>run
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.runInput">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>runInput
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.test">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>test
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.toFunction">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>toFunction
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.toJSON">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>toJSON
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.train">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>train
            <span class="apidocSignatureSpan">(data, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.trainPattern">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>trainPattern
            <span class="apidocSignatureSpan">(input, target, learningRate)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.adjustWeights">module brain.NeuralNetwork.prototype.adjustWeights</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.adjustWeights.adjustWeights">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>adjustWeights
            <span class="apidocSignatureSpan">(learningRate)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.calculateDeltas">module brain.NeuralNetwork.prototype.calculateDeltas</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.calculateDeltas.calculateDeltas">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>calculateDeltas
            <span class="apidocSignatureSpan">(target)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.createTrainStream">module brain.NeuralNetwork.prototype.createTrainStream</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.createTrainStream.createTrainStream">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>createTrainStream
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.formatData">module brain.NeuralNetwork.prototype.formatData</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.formatData.formatData">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>formatData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.fromJSON">module brain.NeuralNetwork.prototype.fromJSON</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.fromJSON.fromJSON">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>fromJSON
            <span class="apidocSignatureSpan">(json)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.initialize">module brain.NeuralNetwork.prototype.initialize</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.initialize.initialize">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>initialize
            <span class="apidocSignatureSpan">(sizes)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.run">module brain.NeuralNetwork.prototype.run</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.run.run">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>run
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.runInput">module brain.NeuralNetwork.prototype.runInput</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.runInput.runInput">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>runInput
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.test">module brain.NeuralNetwork.prototype.test</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.test.test">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>test
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.toFunction">module brain.NeuralNetwork.prototype.toFunction</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.toFunction.toFunction">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>toFunction
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.toJSON">module brain.NeuralNetwork.prototype.toJSON</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.toJSON.toJSON">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>toJSON
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.train">module brain.NeuralNetwork.prototype.train</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.train.train">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>train
            <span class="apidocSignatureSpan">(data, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.NeuralNetwork.prototype.trainPattern">module brain.NeuralNetwork.prototype.trainPattern</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.NeuralNetwork.prototype.trainPattern.trainPattern">
            function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>trainPattern
            <span class="apidocSignatureSpan">(input, target, learningRate)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.crossValidate">module brain.crossValidate</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.crossValidate.crossValidate">
            function <span class="apidocSignatureSpan">brain.</span>crossValidate
            <span class="apidocSignatureSpan">(classifierConst, data, opts, trainOpts, k)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.lookup">module brain.lookup</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.lookup.buildLookup">
            function <span class="apidocSignatureSpan">brain.lookup.</span>buildLookup
            <span class="apidocSignatureSpan">(hashes)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.lookup.lookupFromArray">
            function <span class="apidocSignatureSpan">brain.lookup.</span>lookupFromArray
            <span class="apidocSignatureSpan">(array)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.lookup.lookupFromHash">
            function <span class="apidocSignatureSpan">brain.lookup.</span>lookupFromHash
            <span class="apidocSignatureSpan">(hash)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.lookup.toArray">
            function <span class="apidocSignatureSpan">brain.lookup.</span>toArray
            <span class="apidocSignatureSpan">(lookup, hash)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.lookup.toHash">
            function <span class="apidocSignatureSpan">brain.lookup.</span>toHash
            <span class="apidocSignatureSpan">(lookup, array)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.brain.neuralnetwork">module brain.neuralnetwork</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.brain.neuralnetwork.NeuralNetwork">
            function <span class="apidocSignatureSpan">brain.neuralnetwork.</span>NeuralNetwork
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain" id="apidoc.module.brain">module brain</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork" id="apidoc.element.brain.NeuralNetwork">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork = function (options) {
  options = options || {};
  this.learningRate = options.learningRate || 0.3;
  this.momentum = options.momentum || 0.1;
  this.hiddenSizes = options.hiddenLayers;

  this.binaryThresh = options.binaryThresh || 0.5;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



# brain
`brain` is a JavaScript [neural network](http://en.wikipedia.org/wiki/Artificial_neural_network) library. Here&#x27;s an example
 of using it to approximate the XOR function:

```javascript
var net = new brain.<span class="apidocCodeKeywordSpan">NeuralNetwork</span>();

net.train([{input: [0, 0], output: [0]},
           {input: [0, 1], output: [1]},
           {input: [1, 0], output: [1]},
           {input: [1, 1], output: [0]}]);

var output = net.run([1, 0]);  // [0.987]
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.adjustWeights" id="apidoc.element.brain.NeuralNetwork.prototype.adjustWeights">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.adjustWeights
        <span class="apidocSignatureSpan">(learningRate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.adjustWeights = function (learningRate) {
  for (var layer = 1; layer &#x3c;= this.outputLayer; layer++) {
    var incoming = this.outputs[layer - 1];

    for (var node = 0; node &#x3c; this.sizes[layer]; node++) {
      var delta = this.deltas[layer][node];

      for (var k = 0; k &#x3c; incoming.length; k++) {
        var change = this.changes[layer][node][k];

        change = (learningRate * delta * incoming[k])
                 + (this.momentum * change);

        this.changes[layer][node][k] = change;
        this.weights[layer][node][k] += change;
      }
      this.biases[layer][node] += learningRate * delta;
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.calculateDeltas" id="apidoc.element.brain.NeuralNetwork.prototype.calculateDeltas">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.calculateDeltas
        <span class="apidocSignatureSpan">(target)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.calculateDeltas = function (target) {
  for (var layer = this.outputLayer; layer &#x3e;= 0; layer--) {
    for (var node = 0; node &#x3c; this.sizes[layer]; node++) {
      var output = this.outputs[layer][node];

      var error = 0;
      if (layer == this.outputLayer) {
        error = target[node] - output;
      }
      else {
        var deltas = this.deltas[layer + 1];
        for (var k = 0; k &#x3c; deltas.length; k++) {
          error += deltas[k] * this.weights[layer + 1][k][node];
        }
      }
      this.errors[layer][node] = error;
      this.deltas[layer][node] = error * output * (1 - output);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.createTrainStream" id="apidoc.element.brain.NeuralNetwork.prototype.createTrainStream">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.createTrainStream
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.createTrainStream = function (opts) {
  opts = opts || {};
  opts.neuralNetwork = this;
  this.trainStream = new TrainStream(opts);
  return this.trainStream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.formatData" id="apidoc.element.brain.NeuralNetwork.prototype.formatData">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.formatData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.formatData = function (data) {
  if (!_.isArray(data)) { // turn stream datum into array
    var tmp = [];
    tmp.push(data);
    data = tmp;
  }
  // turn sparse hash input into arrays with 0s as filler
  var datum = data[0].input;
  if (!_(datum).isArray() &#x26;&#x26; !(datum instanceof Float64Array)) {
    if (!this.inputLookup) {
      this.inputLookup = lookup.buildLookup(_(data).pluck(&#x22;input&#x22;));
    }
    data = data.map(function(datum) {
      var array = lookup.toArray(this.inputLookup, datum.input)
      return _(_(datum).clone()).extend({ input: array });
    }, this);
  }

  if (!_(data[0].output).isArray()) {
    if (!this.outputLookup) {
      this.outputLookup = lookup.buildLookup(_(data).pluck(&#x22;output&#x22;));
    }
    data = data.map(function(datum) {
      var array = lookup.toArray(this.outputLookup, datum.output);
      return _(_(datum).clone()).extend({ output: array });
    }, this);
  }
  return data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.fromJSON" id="apidoc.element.brain.NeuralNetwork.prototype.fromJSON">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.fromJSON
        <span class="apidocSignatureSpan">(json)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.fromJSON = function (json) {
  var size = json.layers.length;
  this.outputLayer = size - 1;

  this.sizes = new Array(size);
  this.weights = new Array(size);
  this.biases = new Array(size);
  this.outputs = new Array(size);

  for (var i = 0; i &#x3c;= this.outputLayer; i++) {
    var layer = json.layers[i];
    if (i == 0 &#x26;&#x26; (!layer[0] || json.inputLookup)) {
      this.inputLookup = lookup.lookupFromHash(layer);
    }
    else if (i == this.outputLayer &#x26;&#x26; (!layer[0] || json.outputLookup)) {
      this.outputLookup = lookup.lookupFromHash(layer);
    }

    var nodes = _(layer).keys();
    this.sizes[i] = nodes.length;
    this.weights[i] = [];
    this.biases[i] = [];
    this.outputs[i] = [];

    for (var j in nodes) {
      var node = nodes[j];
      this.biases[i][j] = layer[node].bias;
      this.weights[i][j] = _(layer[node].weights).toArray();
    }
  }
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.initialize" id="apidoc.element.brain.NeuralNetwork.prototype.initialize">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.initialize
        <span class="apidocSignatureSpan">(sizes)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.initialize = function (sizes) {
  this.sizes = sizes;
  this.outputLayer = this.sizes.length - 1;

  this.biases = []; // weights for bias nodes
  this.weights = [];
  this.outputs = [];

  // state for training
  this.deltas = [];
  this.changes = []; // for momentum
  this.errors = [];

  for (var layer = 0; layer &#x3c;= this.outputLayer; layer++) {
    var size = this.sizes[layer];
    this.deltas[layer] = zeros(size);
    this.errors[layer] = zeros(size);
    this.outputs[layer] = zeros(size);

    if (layer &#x3e; 0) {
      this.biases[layer] = randos(size);
      this.weights[layer] = new Array(size);
      this.changes[layer] = new Array(size);

      for (var node = 0; node &#x3c; size; node++) {
        var prevSize = this.sizes[layer - 1];
        this.weights[layer][node] = randos(prevSize);
        this.changes[layer][node] = zeros(prevSize);
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.run" id="apidoc.element.brain.NeuralNetwork.prototype.run">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.run
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.run = function (input) {
  if (this.inputLookup) {
    input = lookup.toArray(this.inputLookup, input);
  }

  var output = this.runInput(input);

  if (this.outputLookup) {
    output = lookup.toHash(this.outputLookup, output);
  }
  return output;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.runInput" id="apidoc.element.brain.NeuralNetwork.prototype.runInput">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.runInput
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.runInput = function (input) {
  this.outputs[0] = input;  // set output state of input layer

  for (var layer = 1; layer &#x3c;= this.outputLayer; layer++) {
    for (var node = 0; node &#x3c; this.sizes[layer]; node++) {
      var weights = this.weights[layer][node];

      var sum = this.biases[layer][node];
      for (var k = 0; k &#x3c; weights.length; k++) {
        sum += weights[k] * input[k];
      }
      this.outputs[layer][node] = 1 / (1 + Math.exp(-sum));
    }
    var output = input = this.outputs[layer];
  }
  return output;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.test" id="apidoc.element.brain.NeuralNetwork.prototype.test">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.test
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.test = function (data) {
  data = this.formatData(data);

  // for binary classification problems with one output node
  var isBinary = data[0].output.length == 1;
  var falsePos = 0,
      falseNeg = 0,
      truePos = 0,
      trueNeg = 0;

  // for classification problems
  var misclasses = [];

  // run each pattern through the trained network and collect
  // error and misclassification statistics
  var sum = 0;
  for (var i = 0; i &#x3c; data.length; i++) {
    var output = this.runInput(data[i].input);
    var target = data[i].output;

    var actual, expected;
    if (isBinary) {
      actual = output[0] &#x3e; this.binaryThresh ? 1 : 0;
      expected = target[0];
    }
    else {
      actual = output.indexOf(_(output).max());
      expected = target.indexOf(_(target).max());
    }

    if (actual != expected) {
      var misclass = data[i];
      _(misclass).extend({
        actual: actual,
        expected: expected
      })
      misclasses.push(misclass);
    }

    if (isBinary) {
      if (actual == 0 &#x26;&#x26; expected == 0) {
        trueNeg++;
      }
      else if (actual == 1 &#x26;&#x26; expected == 1) {
        truePos++;
      }
      else if (actual == 0 &#x26;&#x26; expected == 1) {
        falseNeg++;
      }
      else if (actual == 1 &#x26;&#x26; expected == 0) {
        falsePos++;
      }
    }

    var errors = output.map(function(value, i) {
      return target[i] - value;
    });
    sum += mse(errors);
  }
  var error = sum / data.length;

  var stats = {
    error: error,
    misclasses: misclasses
  };

  if (isBinary) {
    _(stats).extend({
      trueNeg: trueNeg,
      truePos: truePos,
      falseNeg: falseNeg,
      falsePos: falsePos,
      total: data.length,
      precision: truePos / (truePos + falsePos),
      recall: truePos / (truePos + falseNeg),
      accuracy: (trueNeg + truePos) / data.length
    })
  }
  return stats;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.toFunction" id="apidoc.element.brain.NeuralNetwork.prototype.toFunction">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.toFunction
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.toFunction = function () {
  var json = this.toJSON();
  // return standalone function that mimics run()
  return new Function(&#x22;input&#x22;,
&#x27;  var net = &#x27; + JSON.stringify(json) + &#x27;;\n\n\
for (var i = 1; i &#x3c; net.layers.length; i++) {\n\
  var layer = net.layers[i];\n\
  var output = {};\n\
  \n\
  for (var id in layer) {\n\
    var node = layer[id];\n\
    var sum = node.bias;\n\
    \n\
    for (var iid in node.weights) {\n\
      sum += node.weights[iid] * input[iid];\n\
    }\n\
    output[id] = (1 / (1 + Math.exp(-sum)));\n\
  }\n\
  input = output;\n\
}\n\
return output;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.toJSON" id="apidoc.element.brain.NeuralNetwork.prototype.toJSON">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.toJSON
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.toJSON = function () {
<span class="apidocCodeCommentSpan">  /* make json look like:
    {
      layers: [
        { x: {},
          y: {}},
        {&#x27;0&#x27;: {bias: -0.98771313, weights: {x: 0.8374838, y: 1.245858},
         &#x27;1&#x27;: {bias: 3.48192004, weights: {x: 1.7825821, y: -2.67899}}},
        { f: {bias: 0.27205739, weights: {&#x27;0&#x27;: 1.3161821, &#x27;1&#x27;: 2.00436}}}
      ]
    }
  */
</span>  var layers = [];
  for (var layer = 0; layer &#x3c;= this.outputLayer; layer++) {
    layers[layer] = {};

    var nodes;
    // turn any internal arrays back into hashes for readable json
    if (layer == 0 &#x26;&#x26; this.inputLookup) {
      nodes = _(this.inputLookup).keys();
    }
    else if (layer == this.outputLayer &#x26;&#x26; this.outputLookup) {
      nodes = _(this.outputLookup).keys();
    }
    else {
      nodes = _.range(0, this.sizes[layer]);
    }

    for (var j = 0; j &#x3c; nodes.length; j++) {
      var node = nodes[j];
      layers[layer][node] = {};

      if (layer &#x3e; 0) {
        layers[layer][node].bias = this.biases[layer][j];
        layers[layer][node].weights = {};
        for (var k in layers[layer - 1]) {
          var index = k;
          if (layer == 1 &#x26;&#x26; this.inputLookup) {
            index = this.inputLookup[k];
          }
          layers[layer][node].weights[k] = this.weights[layer][j][index];
        }
      }
    }
  }
  return { layers: layers, outputLookup:!!this.outputLookup, inputLookup:!!this.inputLookup };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.train" id="apidoc.element.brain.NeuralNetwork.prototype.train">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.train
        <span class="apidocSignatureSpan">(data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.train = function (data, options) {
  data = this.formatData(data);

  options = options || {};
  var iterations = options.iterations || 20000;
  var errorThresh = options.errorThresh || 0.005;
  var log = options.log || false;
  var logPeriod = options.logPeriod || 10;
  var learningRate = options.learningRate || this.learningRate || 0.3;
  var callback = options.callback;
  var callbackPeriod = options.callbackPeriod || 10;

  var inputSize = data[0].input.length;
  var outputSize = data[0].output.length;

  var hiddenSizes = this.hiddenSizes;
  if (!hiddenSizes) {
    hiddenSizes = [Math.max(3, Math.floor(inputSize / 2))];
  }
  var sizes = _([inputSize, hiddenSizes, outputSize]).flatten();
  this.initialize(sizes);

  var error = 1;
  for (var i = 0; i &#x3c; iterations &#x26;&#x26; error &#x3e; errorThresh; i++) {
    var sum = 0;
    for (var j = 0; j &#x3c; data.length; j++) {
      var err = this.trainPattern(data[j].input, data[j].output, learningRate);
      sum += err;
    }
    error = sum / data.length;

    if (log &#x26;&#x26; (i % logPeriod == 0)) {
      console.log(&#x22;iterations:&#x22;, i, &#x22;training error:&#x22;, error);
    }
    if (callback &#x26;&#x26; (i % callbackPeriod == 0)) {
      callback({ error: error, iterations: i });
    }
  }

  return {
    error: error,
    iterations: i
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.trainPattern" id="apidoc.element.brain.NeuralNetwork.prototype.trainPattern">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork.prototype.trainPattern
        <span class="apidocSignatureSpan">(input, target, learningRate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork.prototype.trainPattern = function (input, target, learningRate) {
  learningRate = learningRate || this.learningRate;

  // forward propogate
  this.runInput(input);

  // back propogate
  this.calculateDeltas(target);
  this.adjustWeights(learningRate);

  var error = mse(this.errors[this.outputLayer]);
  return error;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.crossValidate" id="apidoc.element.brain.crossValidate">
        function <span class="apidocSignatureSpan">brain.</span>crossValidate
        <span class="apidocSignatureSpan">(classifierConst, data, opts, trainOpts, k)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function crossValidate(classifierConst, data, opts, trainOpts, k) {
  k = k || 4;
  var size = data.length / k;

  data = _(data).sortBy(function() {
    return Math.random();
  });

  var avgs = {
    error : 0,
    trainTime : 0,
    testTime : 0,
    iterations: 0,
    trainError: 0
  };

  var stats = {
    truePos: 0,
    trueNeg: 0,
    falsePos: 0,
    falseNeg: 0,
    total: 0
  };

  var misclasses = [];

  var results = _.range(k).map(function(i) {
    var dclone = _(data).clone();
    var testSet = dclone.splice(i * size, size);
    var trainSet = dclone;

    var result = testPartition(classifierConst, opts, trainOpts, trainSet, testSet);

    _(avgs).each(function(sum, stat) {
      avgs[stat] = sum + result[stat];
    });

    _(stats).each(function(sum, stat) {
      stats[stat] = sum + result[stat];
    })

    misclasses.push(result.misclasses);

    return result;
  });

  _(avgs).each(function(sum, i) {
    avgs[i] = sum / k;
  });

  stats.precision = stats.truePos / (stats.truePos + stats.falsePos);
  stats.recall = stats.truePos / (stats.truePos + stats.falseNeg);
  stats.accuracy = (stats.trueNeg + stats.truePos) / stats.total;

  stats.testSize = size;
  stats.trainSize = data.length - size;

  return {
    avgs: avgs,
    stats: stats,
    sets: results,
    misclasses: _(misclasses).flatten()
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork" id="apidoc.module.brain.NeuralNetwork">module brain.NeuralNetwork</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.NeuralNetwork" id="apidoc.element.brain.NeuralNetwork.NeuralNetwork">
        function <span class="apidocSignatureSpan">brain.</span>NeuralNetwork
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork = function (options) {
  options = options || {};
  this.learningRate = options.learningRate || 0.3;
  this.momentum = options.momentum || 0.1;
  this.hiddenSizes = options.hiddenLayers;

  this.binaryThresh = options.binaryThresh || 0.5;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



# brain
`brain` is a JavaScript [neural network](http://en.wikipedia.org/wiki/Artificial_neural_network) library. Here&#x27;s an example
 of using it to approximate the XOR function:

```javascript
var net = new brain.<span class="apidocCodeKeywordSpan">NeuralNetwork</span>();

net.train([{input: [0, 0], output: [0]},
           {input: [0, 1], output: [1]},
           {input: [1, 0], output: [1]},
           {input: [1, 1], output: [0]}]);

var output = net.run([1, 0]);  // [0.987]
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype" id="apidoc.module.brain.NeuralNetwork.prototype">module brain.NeuralNetwork.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.adjustWeights" id="apidoc.element.brain.NeuralNetwork.prototype.adjustWeights">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>adjustWeights
        <span class="apidocSignatureSpan">(learningRate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">adjustWeights = function (learningRate) {
  for (var layer = 1; layer &#x3c;= this.outputLayer; layer++) {
    var incoming = this.outputs[layer - 1];

    for (var node = 0; node &#x3c; this.sizes[layer]; node++) {
      var delta = this.deltas[layer][node];

      for (var k = 0; k &#x3c; incoming.length; k++) {
        var change = this.changes[layer][node][k];

        change = (learningRate * delta * incoming[k])
                 + (this.momentum * change);

        this.changes[layer][node][k] = change;
        this.weights[layer][node][k] += change;
      }
      this.biases[layer][node] += learningRate * delta;
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

trainPattern : function(input, target) {
  // forward propogate
  this.runInput(input);

  // back propogate
  this.calculateDeltas(target);
  this.<span class="apidocCodeKeywordSpan">adjustWeights</span>();

  var error = mse(this.errors[this.outputLayer]);
  return error;
},

calculateDeltas: function(target) {
  for (var layer = this.outputLayer; layer &#x3e;= 0; layer--) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.calculateDeltas" id="apidoc.element.brain.NeuralNetwork.prototype.calculateDeltas">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>calculateDeltas
        <span class="apidocSignatureSpan">(target)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">calculateDeltas = function (target) {
  for (var layer = this.outputLayer; layer &#x3e;= 0; layer--) {
    for (var node = 0; node &#x3c; this.sizes[layer]; node++) {
      var output = this.outputs[layer][node];

      var error = 0;
      if (layer == this.outputLayer) {
        error = target[node] - output;
      }
      else {
        var deltas = this.deltas[layer + 1];
        for (var k = 0; k &#x3c; deltas.length; k++) {
          error += deltas[k] * this.weights[layer + 1][k][node];
        }
      }
      this.errors[layer][node] = error;
      this.deltas[layer][node] = error * output * (1 - output);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

trainPattern : function(input, target) {
  // forward propogate
  this.runInput(input);

  // back propogate
  this.<span class="apidocCodeKeywordSpan">calculateDeltas</span>(target);
  this.adjustWeights();

  var error = mse(this.errors[this.outputLayer]);
  return error;
},

calculateDeltas: function(target) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.createTrainStream" id="apidoc.element.brain.NeuralNetwork.prototype.createTrainStream">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>createTrainStream
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createTrainStream = function (opts) {
  opts = opts || {};
  opts.neuralNetwork = this;
  this.trainStream = new TrainStream(opts);
  return this.trainStream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
## Streams
The network now has a [WriteStream](http://nodejs.org/api/stream.html#stream_class_stream_writable). You can train the network by
 using `pipe()` to send the training data to the network.

#### Example
Refer to `stream-example.js` for an example on how to train the network with a stream.

#### Initialization
To train the network using a stream you must first create the stream by calling `net.<span class="apidocCodeKeywordSpan">createTrainStream
</span>()` which takes the following options:

* `floodCallback()` - the callback function to re-populate the stream. This gets called on every training iteration.
* `doneTrainingCallback(info)` - the callback function to execute when the network is done training. The `info` param will contain
 a hash of information about how the training went:

```javascript
{
error: 0.0039139985510105032,  // training error
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.formatData" id="apidoc.element.brain.NeuralNetwork.prototype.formatData">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>formatData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">formatData = function (data) {
  if (!_.isArray(data)) { // turn stream datum into array
    var tmp = [];
    tmp.push(data);
    data = tmp;
  }
  // turn sparse hash input into arrays with 0s as filler
  var datum = data[0].input;
  if (!_(datum).isArray() &#x26;&#x26; !(datum instanceof Float64Array)) {
    if (!this.inputLookup) {
      this.inputLookup = lookup.buildLookup(_(data).pluck(&#x22;input&#x22;));
    }
    data = data.map(function(datum) {
      var array = lookup.toArray(this.inputLookup, datum.input)
      return _(_(datum).clone()).extend({ input: array });
    }, this);
  }

  if (!_(data[0].output).isArray()) {
    if (!this.outputLookup) {
      this.outputLookup = lookup.buildLookup(_(data).pluck(&#x22;output&#x22;));
    }
    data = data.map(function(datum) {
      var array = lookup.toArray(this.outputLookup, datum.output);
      return _(_(datum).clone()).extend({ output: array });
    }, this);
  }
  return data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
  var output = input = this.outputs[layer];
}
return output;
  },

  train: function(data, errorThresh, iterations) {
data = this.<span class="apidocCodeKeywordSpan">formatData</span>(data);
iterations = iterations || 20000;
errorThresh = errorThresh || 0.004;

var inputSize = data[0].input.length;
var outputSize = data[0].output.length;

var hiddenSizes = this.hiddenSizes;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.fromJSON" id="apidoc.element.brain.NeuralNetwork.prototype.fromJSON">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>fromJSON
        <span class="apidocSignatureSpan">(json)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fromJSON = function (json) {
  var size = json.layers.length;
  this.outputLayer = size - 1;

  this.sizes = new Array(size);
  this.weights = new Array(size);
  this.biases = new Array(size);
  this.outputs = new Array(size);

  for (var i = 0; i &#x3c;= this.outputLayer; i++) {
    var layer = json.layers[i];
    if (i == 0 &#x26;&#x26; (!layer[0] || json.inputLookup)) {
      this.inputLookup = lookup.lookupFromHash(layer);
    }
    else if (i == this.outputLayer &#x26;&#x26; (!layer[0] || json.outputLookup)) {
      this.outputLookup = lookup.lookupFromHash(layer);
    }

    var nodes = _(layer).keys();
    this.sizes[i] = nodes.length;
    this.weights[i] = [];
    this.biases[i] = [];
    this.outputs[i] = [];

    for (var j in nodes) {
      var node = nodes[j];
      this.biases[i][j] = layer[node].bias;
      this.weights[i][j] = _(layer[node].weights).toArray();
    }
  }
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

## JSON
Serialize or load in the state of a trained network with JSON:

```javascript
var json = net.toJSON();

net.<span class="apidocCodeKeywordSpan">fromJSON</span>(json);
```

You can also get a custom standalone function from a trained network that acts just like `run()`:

```javascript
var run = net.toFunction();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.initialize" id="apidoc.element.brain.NeuralNetwork.prototype.initialize">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>initialize
        <span class="apidocSignatureSpan">(sizes)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">initialize = function (sizes) {
  this.sizes = sizes;
  this.outputLayer = this.sizes.length - 1;

  this.biases = []; // weights for bias nodes
  this.weights = [];
  this.outputs = [];

  // state for training
  this.deltas = [];
  this.changes = []; // for momentum
  this.errors = [];

  for (var layer = 0; layer &#x3c;= this.outputLayer; layer++) {
    var size = this.sizes[layer];
    this.deltas[layer] = zeros(size);
    this.errors[layer] = zeros(size);
    this.outputs[layer] = zeros(size);

    if (layer &#x3e; 0) {
      this.biases[layer] = randos(size);
      this.weights[layer] = new Array(size);
      this.changes[layer] = new Array(size);

      for (var node = 0; node &#x3c; size; node++) {
        var prevSize = this.sizes[layer - 1];
        this.weights[layer][node] = randos(prevSize);
        this.changes[layer][node] = zeros(prevSize);
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var outputSize = data[0].output.length;

var hiddenSizes = this.hiddenSizes;
if (!hiddenSizes) {
  hiddenSizes = [Math.max(3, inputSize)];
}
var sizes = _([inputSize, hiddenSizes, outputSize]).flatten();
this.<span class="apidocCodeKeywordSpan">initialize</span>(sizes);

var error = 1;
for (var i = 0; i &#x3c; iterations &#x26;&#x26; error &#x3e; errorThresh; i++) {
  var sum = 0;
  for (var j = 0; j &#x3c; data.length; j++) {
    sum += this.trainPattern(data[j].input, data[j].output);
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.run" id="apidoc.element.brain.NeuralNetwork.prototype.run">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>run
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (input) {
  if (this.inputLookup) {
    input = lookup.toArray(this.inputLookup, input);
  }

  var output = this.runInput(input);

  if (this.outputLookup) {
    output = lookup.toHash(this.outputLookup, output);
  }
  return output;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var net = new brain.NeuralNetwork();

net.train([{input: [0, 0], output: [0]},
           {input: [0, 1], output: [1]},
           {input: [1, 0], output: [1]},
           {input: [1, 1], output: [0]}]);

var output = net.<span class="apidocCodeKeywordSpan">run</span>([1, 0]);  // [0.987]
```

There&#x27;s no reason to use a neural network to figure out XOR however (-: so here&#x27;s a more involved, realistic example:
[Demo: training a neural network to recognize color contrast](http://harthur.github.com/brain/)

## Using in node
If you have [node](http://nodejs.org/) you can install with [npm](http://github.com/isaacs/npm):
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.runInput" id="apidoc.element.brain.NeuralNetwork.prototype.runInput">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>runInput
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">runInput = function (input) {
  this.outputs[0] = input;  // set output state of input layer

  for (var layer = 1; layer &#x3c;= this.outputLayer; layer++) {
    for (var node = 0; node &#x3c; this.sizes[layer]; node++) {
      var weights = this.weights[layer][node];

      var sum = this.biases[layer][node];
      for (var k = 0; k &#x3c; weights.length; k++) {
        sum += weights[k] * input[k];
      }
      this.outputs[layer][node] = 1 / (1 + Math.exp(-sum));
    }
    var output = input = this.outputs[layer];
  }
  return output;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

run: function(input) {
  if (this.inputLookup) {
    input = lookup.toArray(this.inputLookup, input);
  }

  var output = this.<span class="apidocCodeKeywordSpan">runInput</span>(input);

  if (this.outputLookup) {
    output = lookup.toHash(this.outputLookup, output);
  }
  return output;
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.test" id="apidoc.element.brain.NeuralNetwork.prototype.test">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>test
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">test = function (data) {
  data = this.formatData(data);

  // for binary classification problems with one output node
  var isBinary = data[0].output.length == 1;
  var falsePos = 0,
      falseNeg = 0,
      truePos = 0,
      trueNeg = 0;

  // for classification problems
  var misclasses = [];

  // run each pattern through the trained network and collect
  // error and misclassification statistics
  var sum = 0;
  for (var i = 0; i &#x3c; data.length; i++) {
    var output = this.runInput(data[i].input);
    var target = data[i].output;

    var actual, expected;
    if (isBinary) {
      actual = output[0] &#x3e; this.binaryThresh ? 1 : 0;
      expected = target[0];
    }
    else {
      actual = output.indexOf(_(output).max());
      expected = target.indexOf(_(target).max());
    }

    if (actual != expected) {
      var misclass = data[i];
      _(misclass).extend({
        actual: actual,
        expected: expected
      })
      misclasses.push(misclass);
    }

    if (isBinary) {
      if (actual == 0 &#x26;&#x26; expected == 0) {
        trueNeg++;
      }
      else if (actual == 1 &#x26;&#x26; expected == 1) {
        truePos++;
      }
      else if (actual == 0 &#x26;&#x26; expected == 1) {
        falseNeg++;
      }
      else if (actual == 1 &#x26;&#x26; expected == 0) {
        falsePos++;
      }
    }

    var errors = output.map(function(value, i) {
      return target[i] - value;
    });
    sum += mse(errors);
  }
  var error = sum / data.length;

  var stats = {
    error: error,
    misclasses: misclasses
  };

  if (isBinary) {
    _(stats).extend({
      trueNeg: trueNeg,
      truePos: truePos,
      falseNeg: falseNeg,
      falsePos: falsePos,
      total: data.length,
      precision: truePos / (truePos + falsePos),
      recall: truePos / (truePos + falseNeg),
      accuracy: (trueNeg + truePos) / data.length
    })
  }
  return stats;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var beginTrain = Date.now();

var trainingStats = classifier.train(trainSet);

var beginTest = Date.now();

var testStats = classifier.<span class="apidocCodeKeywordSpan">test</span>(testSet);

var endTest = Date.now();

return {
  error : testStats.error,
  misclasses: testStats.misclasses,
  trainTime : beginTest - beginTrain,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.toFunction" id="apidoc.element.brain.NeuralNetwork.prototype.toFunction">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>toFunction
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toFunction = function () {
  var json = this.toJSON();
  // return standalone function that mimics run()
  return new Function(&#x22;input&#x22;,
&#x27;  var net = &#x27; + JSON.stringify(json) + &#x27;;\n\n\
for (var i = 1; i &#x3c; net.layers.length; i++) {\n\
  var layer = net.layers[i];\n\
  var output = {};\n\
  \n\
  for (var id in layer) {\n\
    var node = layer[id];\n\
    var sum = node.bias;\n\
    \n\
    for (var iid in node.weights) {\n\
      sum += node.weights[iid] * input[iid];\n\
    }\n\
    output[id] = (1 / (1 + Math.exp(-sum)));\n\
  }\n\
  input = output;\n\
}\n\
return output;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

net.fromJSON(json);
```

You can also get a custom standalone function from a trained network that acts just like `run()`:

```javascript
var run = net.<span class="apidocCodeKeywordSpan">toFunction</span>();

var output = run({ r: 1, g: 0.4, b: 0 });

console.log(run.toString()); // copy and paste! no need to import brain.js
```
## Streams
The network now has a [WriteStream](http://nodejs.org/api/stream.html#stream_class_stream_writable). You can train the network by
 using `pipe()` to send the training data to the network.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.toJSON" id="apidoc.element.brain.NeuralNetwork.prototype.toJSON">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>toJSON
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toJSON = function () {
<span class="apidocCodeCommentSpan">  /* make json look like:
    {
      layers: [
        { x: {},
          y: {}},
        {&#x27;0&#x27;: {bias: -0.98771313, weights: {x: 0.8374838, y: 1.245858},
         &#x27;1&#x27;: {bias: 3.48192004, weights: {x: 1.7825821, y: -2.67899}}},
        { f: {bias: 0.27205739, weights: {&#x27;0&#x27;: 1.3161821, &#x27;1&#x27;: 2.00436}}}
      ]
    }
  */
</span>  var layers = [];
  for (var layer = 0; layer &#x3c;= this.outputLayer; layer++) {
    layers[layer] = {};

    var nodes;
    // turn any internal arrays back into hashes for readable json
    if (layer == 0 &#x26;&#x26; this.inputLookup) {
      nodes = _(this.inputLookup).keys();
    }
    else if (layer == this.outputLayer &#x26;&#x26; this.outputLookup) {
      nodes = _(this.outputLookup).keys();
    }
    else {
      nodes = _.range(0, this.sizes[layer]);
    }

    for (var j = 0; j &#x3c; nodes.length; j++) {
      var node = nodes[j];
      layers[layer][node] = {};

      if (layer &#x3e; 0) {
        layers[layer][node].bias = this.biases[layer][j];
        layers[layer][node].weights = {};
        for (var k in layers[layer - 1]) {
          var index = k;
          if (layer == 1 &#x26;&#x26; this.inputLookup) {
            index = this.inputLookup[k];
          }
          layers[layer][node].weights[k] = this.weights[layer][j][index];
        }
      }
    }
  }
  return { layers: layers, outputLookup:!!this.outputLookup, inputLookup:!!this.inputLookup };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

If the training error is still something huge like `0.4` after 20000 iterations, it&#x27;s a good sign that the network can&#x27
;t make sense of the data you&#x27;re giving it.

## JSON
Serialize or load in the state of a trained network with JSON:

```javascript
var json = net.<span class="apidocCodeKeywordSpan">toJSON</span>();

net.fromJSON(json);
```

You can also get a custom standalone function from a trained network that acts just like `run()`:

```javascript
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.train" id="apidoc.element.brain.NeuralNetwork.prototype.train">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>train
        <span class="apidocSignatureSpan">(data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">train = function (data, options) {
  data = this.formatData(data);

  options = options || {};
  var iterations = options.iterations || 20000;
  var errorThresh = options.errorThresh || 0.005;
  var log = options.log || false;
  var logPeriod = options.logPeriod || 10;
  var learningRate = options.learningRate || this.learningRate || 0.3;
  var callback = options.callback;
  var callbackPeriod = options.callbackPeriod || 10;

  var inputSize = data[0].input.length;
  var outputSize = data[0].output.length;

  var hiddenSizes = this.hiddenSizes;
  if (!hiddenSizes) {
    hiddenSizes = [Math.max(3, Math.floor(inputSize / 2))];
  }
  var sizes = _([inputSize, hiddenSizes, outputSize]).flatten();
  this.initialize(sizes);

  var error = 1;
  for (var i = 0; i &#x3c; iterations &#x26;&#x26; error &#x3e; errorThresh; i++) {
    var sum = 0;
    for (var j = 0; j &#x3c; data.length; j++) {
      var err = this.trainPattern(data[j].input, data[j].output, learningRate);
      sum += err;
    }
    error = sum / data.length;

    if (log &#x26;&#x26; (i % logPeriod == 0)) {
      console.log(&#x22;iterations:&#x22;, i, &#x22;training error:&#x22;, error);
    }
    if (callback &#x26;&#x26; (i % callbackPeriod == 0)) {
      callback({ error: error, iterations: i });
    }
  }

  return {
    error: error,
    iterations: i
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

# brain
`brain` is a JavaScript [neural network](http://en.wikipedia.org/wiki/Artificial_neural_network) library. Here&#x27;s an example
 of using it to approximate the XOR function:

```javascript
var net = new brain.NeuralNetwork();

net.<span class="apidocCodeKeywordSpan">train</span>([{input: [0, 0], output: [0]},
           {input: [0, 1], output: [1]},
           {input: [1, 0], output: [1]},
           {input: [1, 1], output: [0]}]);

var output = net.run([1, 0]);  // [0.987]
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.trainPattern" id="apidoc.element.brain.NeuralNetwork.prototype.trainPattern">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>trainPattern
        <span class="apidocSignatureSpan">(input, target, learningRate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">trainPattern = function (input, target, learningRate) {
  learningRate = learningRate || this.learningRate;

  // forward propogate
  this.runInput(input);

  // back propogate
  this.calculateDeltas(target);
  this.adjustWeights(learningRate);

  var error = mse(this.errors[this.outputLayer]);
  return error;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var sizes = _([inputSize, hiddenSizes, outputSize]).flatten();
this.initialize(sizes);

var error = 1;
for (var i = 0; i &#x3c; iterations &#x26;&#x26; error &#x3e; errorThresh; i++) {
  var sum = 0;
  for (var j = 0; j &#x3c; data.length; j++) {
    sum += this.<span class="apidocCodeKeywordSpan">trainPattern</span>(data[j].input, data[j].output);
  }
  error = sum / data.length;
}

return {
  error: error,
  iterations: i
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.adjustWeights" id="apidoc.module.brain.NeuralNetwork.prototype.adjustWeights">module brain.NeuralNetwork.prototype.adjustWeights</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.adjustWeights.adjustWeights" id="apidoc.element.brain.NeuralNetwork.prototype.adjustWeights.adjustWeights">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>adjustWeights
        <span class="apidocSignatureSpan">(learningRate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">adjustWeights = function (learningRate) {
  for (var layer = 1; layer &#x3c;= this.outputLayer; layer++) {
    var incoming = this.outputs[layer - 1];

    for (var node = 0; node &#x3c; this.sizes[layer]; node++) {
      var delta = this.deltas[layer][node];

      for (var k = 0; k &#x3c; incoming.length; k++) {
        var change = this.changes[layer][node][k];

        change = (learningRate * delta * incoming[k])
                 + (this.momentum * change);

        this.changes[layer][node][k] = change;
        this.weights[layer][node][k] += change;
      }
      this.biases[layer][node] += learningRate * delta;
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

trainPattern : function(input, target) {
  // forward propogate
  this.runInput(input);

  // back propogate
  this.calculateDeltas(target);
  this.<span class="apidocCodeKeywordSpan">adjustWeights</span>();

  var error = mse(this.errors[this.outputLayer]);
  return error;
},

calculateDeltas: function(target) {
  for (var layer = this.outputLayer; layer &#x3e;= 0; layer--) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.calculateDeltas" id="apidoc.module.brain.NeuralNetwork.prototype.calculateDeltas">module brain.NeuralNetwork.prototype.calculateDeltas</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.calculateDeltas.calculateDeltas" id="apidoc.element.brain.NeuralNetwork.prototype.calculateDeltas.calculateDeltas">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>calculateDeltas
        <span class="apidocSignatureSpan">(target)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">calculateDeltas = function (target) {
  for (var layer = this.outputLayer; layer &#x3e;= 0; layer--) {
    for (var node = 0; node &#x3c; this.sizes[layer]; node++) {
      var output = this.outputs[layer][node];

      var error = 0;
      if (layer == this.outputLayer) {
        error = target[node] - output;
      }
      else {
        var deltas = this.deltas[layer + 1];
        for (var k = 0; k &#x3c; deltas.length; k++) {
          error += deltas[k] * this.weights[layer + 1][k][node];
        }
      }
      this.errors[layer][node] = error;
      this.deltas[layer][node] = error * output * (1 - output);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

trainPattern : function(input, target) {
  // forward propogate
  this.runInput(input);

  // back propogate
  this.<span class="apidocCodeKeywordSpan">calculateDeltas</span>(target);
  this.adjustWeights();

  var error = mse(this.errors[this.outputLayer]);
  return error;
},

calculateDeltas: function(target) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.createTrainStream" id="apidoc.module.brain.NeuralNetwork.prototype.createTrainStream">module brain.NeuralNetwork.prototype.createTrainStream</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.createTrainStream.createTrainStream" id="apidoc.element.brain.NeuralNetwork.prototype.createTrainStream.createTrainStream">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>createTrainStream
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createTrainStream = function (opts) {
  opts = opts || {};
  opts.neuralNetwork = this;
  this.trainStream = new TrainStream(opts);
  return this.trainStream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
## Streams
The network now has a [WriteStream](http://nodejs.org/api/stream.html#stream_class_stream_writable). You can train the network by
 using `pipe()` to send the training data to the network.

#### Example
Refer to `stream-example.js` for an example on how to train the network with a stream.

#### Initialization
To train the network using a stream you must first create the stream by calling `net.<span class="apidocCodeKeywordSpan">createTrainStream
</span>()` which takes the following options:

* `floodCallback()` - the callback function to re-populate the stream. This gets called on every training iteration.
* `doneTrainingCallback(info)` - the callback function to execute when the network is done training. The `info` param will contain
 a hash of information about how the training went:

```javascript
{
error: 0.0039139985510105032,  // training error
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.formatData" id="apidoc.module.brain.NeuralNetwork.prototype.formatData">module brain.NeuralNetwork.prototype.formatData</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.formatData.formatData" id="apidoc.element.brain.NeuralNetwork.prototype.formatData.formatData">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>formatData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">formatData = function (data) {
  if (!_.isArray(data)) { // turn stream datum into array
    var tmp = [];
    tmp.push(data);
    data = tmp;
  }
  // turn sparse hash input into arrays with 0s as filler
  var datum = data[0].input;
  if (!_(datum).isArray() &#x26;&#x26; !(datum instanceof Float64Array)) {
    if (!this.inputLookup) {
      this.inputLookup = lookup.buildLookup(_(data).pluck(&#x22;input&#x22;));
    }
    data = data.map(function(datum) {
      var array = lookup.toArray(this.inputLookup, datum.input)
      return _(_(datum).clone()).extend({ input: array });
    }, this);
  }

  if (!_(data[0].output).isArray()) {
    if (!this.outputLookup) {
      this.outputLookup = lookup.buildLookup(_(data).pluck(&#x22;output&#x22;));
    }
    data = data.map(function(datum) {
      var array = lookup.toArray(this.outputLookup, datum.output);
      return _(_(datum).clone()).extend({ output: array });
    }, this);
  }
  return data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
  var output = input = this.outputs[layer];
}
return output;
  },

  train: function(data, errorThresh, iterations) {
data = this.<span class="apidocCodeKeywordSpan">formatData</span>(data);
iterations = iterations || 20000;
errorThresh = errorThresh || 0.004;

var inputSize = data[0].input.length;
var outputSize = data[0].output.length;

var hiddenSizes = this.hiddenSizes;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.fromJSON" id="apidoc.module.brain.NeuralNetwork.prototype.fromJSON">module brain.NeuralNetwork.prototype.fromJSON</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.fromJSON.fromJSON" id="apidoc.element.brain.NeuralNetwork.prototype.fromJSON.fromJSON">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>fromJSON
        <span class="apidocSignatureSpan">(json)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fromJSON = function (json) {
  var size = json.layers.length;
  this.outputLayer = size - 1;

  this.sizes = new Array(size);
  this.weights = new Array(size);
  this.biases = new Array(size);
  this.outputs = new Array(size);

  for (var i = 0; i &#x3c;= this.outputLayer; i++) {
    var layer = json.layers[i];
    if (i == 0 &#x26;&#x26; (!layer[0] || json.inputLookup)) {
      this.inputLookup = lookup.lookupFromHash(layer);
    }
    else if (i == this.outputLayer &#x26;&#x26; (!layer[0] || json.outputLookup)) {
      this.outputLookup = lookup.lookupFromHash(layer);
    }

    var nodes = _(layer).keys();
    this.sizes[i] = nodes.length;
    this.weights[i] = [];
    this.biases[i] = [];
    this.outputs[i] = [];

    for (var j in nodes) {
      var node = nodes[j];
      this.biases[i][j] = layer[node].bias;
      this.weights[i][j] = _(layer[node].weights).toArray();
    }
  }
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

## JSON
Serialize or load in the state of a trained network with JSON:

```javascript
var json = net.toJSON();

net.<span class="apidocCodeKeywordSpan">fromJSON</span>(json);
```

You can also get a custom standalone function from a trained network that acts just like `run()`:

```javascript
var run = net.toFunction();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.initialize" id="apidoc.module.brain.NeuralNetwork.prototype.initialize">module brain.NeuralNetwork.prototype.initialize</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.initialize.initialize" id="apidoc.element.brain.NeuralNetwork.prototype.initialize.initialize">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>initialize
        <span class="apidocSignatureSpan">(sizes)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">initialize = function (sizes) {
  this.sizes = sizes;
  this.outputLayer = this.sizes.length - 1;

  this.biases = []; // weights for bias nodes
  this.weights = [];
  this.outputs = [];

  // state for training
  this.deltas = [];
  this.changes = []; // for momentum
  this.errors = [];

  for (var layer = 0; layer &#x3c;= this.outputLayer; layer++) {
    var size = this.sizes[layer];
    this.deltas[layer] = zeros(size);
    this.errors[layer] = zeros(size);
    this.outputs[layer] = zeros(size);

    if (layer &#x3e; 0) {
      this.biases[layer] = randos(size);
      this.weights[layer] = new Array(size);
      this.changes[layer] = new Array(size);

      for (var node = 0; node &#x3c; size; node++) {
        var prevSize = this.sizes[layer - 1];
        this.weights[layer][node] = randos(prevSize);
        this.changes[layer][node] = zeros(prevSize);
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var outputSize = data[0].output.length;

var hiddenSizes = this.hiddenSizes;
if (!hiddenSizes) {
  hiddenSizes = [Math.max(3, inputSize)];
}
var sizes = _([inputSize, hiddenSizes, outputSize]).flatten();
this.<span class="apidocCodeKeywordSpan">initialize</span>(sizes);

var error = 1;
for (var i = 0; i &#x3c; iterations &#x26;&#x26; error &#x3e; errorThresh; i++) {
  var sum = 0;
  for (var j = 0; j &#x3c; data.length; j++) {
    sum += this.trainPattern(data[j].input, data[j].output);
  }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.run" id="apidoc.module.brain.NeuralNetwork.prototype.run">module brain.NeuralNetwork.prototype.run</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.run.run" id="apidoc.element.brain.NeuralNetwork.prototype.run.run">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>run
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (input) {
  if (this.inputLookup) {
    input = lookup.toArray(this.inputLookup, input);
  }

  var output = this.runInput(input);

  if (this.outputLookup) {
    output = lookup.toHash(this.outputLookup, output);
  }
  return output;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var net = new brain.NeuralNetwork();

net.train([{input: [0, 0], output: [0]},
           {input: [0, 1], output: [1]},
           {input: [1, 0], output: [1]},
           {input: [1, 1], output: [0]}]);

var output = net.<span class="apidocCodeKeywordSpan">run</span>([1, 0]);  // [0.987]
```

There&#x27;s no reason to use a neural network to figure out XOR however (-: so here&#x27;s a more involved, realistic example:
[Demo: training a neural network to recognize color contrast](http://harthur.github.com/brain/)

## Using in node
If you have [node](http://nodejs.org/) you can install with [npm](http://github.com/isaacs/npm):
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.runInput" id="apidoc.module.brain.NeuralNetwork.prototype.runInput">module brain.NeuralNetwork.prototype.runInput</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.runInput.runInput" id="apidoc.element.brain.NeuralNetwork.prototype.runInput.runInput">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>runInput
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">runInput = function (input) {
  this.outputs[0] = input;  // set output state of input layer

  for (var layer = 1; layer &#x3c;= this.outputLayer; layer++) {
    for (var node = 0; node &#x3c; this.sizes[layer]; node++) {
      var weights = this.weights[layer][node];

      var sum = this.biases[layer][node];
      for (var k = 0; k &#x3c; weights.length; k++) {
        sum += weights[k] * input[k];
      }
      this.outputs[layer][node] = 1 / (1 + Math.exp(-sum));
    }
    var output = input = this.outputs[layer];
  }
  return output;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

run: function(input) {
  if (this.inputLookup) {
    input = lookup.toArray(this.inputLookup, input);
  }

  var output = this.<span class="apidocCodeKeywordSpan">runInput</span>(input);

  if (this.outputLookup) {
    output = lookup.toHash(this.outputLookup, output);
  }
  return output;
},
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.test" id="apidoc.module.brain.NeuralNetwork.prototype.test">module brain.NeuralNetwork.prototype.test</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.test.test" id="apidoc.element.brain.NeuralNetwork.prototype.test.test">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>test
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">test = function (data) {
  data = this.formatData(data);

  // for binary classification problems with one output node
  var isBinary = data[0].output.length == 1;
  var falsePos = 0,
      falseNeg = 0,
      truePos = 0,
      trueNeg = 0;

  // for classification problems
  var misclasses = [];

  // run each pattern through the trained network and collect
  // error and misclassification statistics
  var sum = 0;
  for (var i = 0; i &#x3c; data.length; i++) {
    var output = this.runInput(data[i].input);
    var target = data[i].output;

    var actual, expected;
    if (isBinary) {
      actual = output[0] &#x3e; this.binaryThresh ? 1 : 0;
      expected = target[0];
    }
    else {
      actual = output.indexOf(_(output).max());
      expected = target.indexOf(_(target).max());
    }

    if (actual != expected) {
      var misclass = data[i];
      _(misclass).extend({
        actual: actual,
        expected: expected
      })
      misclasses.push(misclass);
    }

    if (isBinary) {
      if (actual == 0 &#x26;&#x26; expected == 0) {
        trueNeg++;
      }
      else if (actual == 1 &#x26;&#x26; expected == 1) {
        truePos++;
      }
      else if (actual == 0 &#x26;&#x26; expected == 1) {
        falseNeg++;
      }
      else if (actual == 1 &#x26;&#x26; expected == 0) {
        falsePos++;
      }
    }

    var errors = output.map(function(value, i) {
      return target[i] - value;
    });
    sum += mse(errors);
  }
  var error = sum / data.length;

  var stats = {
    error: error,
    misclasses: misclasses
  };

  if (isBinary) {
    _(stats).extend({
      trueNeg: trueNeg,
      truePos: truePos,
      falseNeg: falseNeg,
      falsePos: falsePos,
      total: data.length,
      precision: truePos / (truePos + falsePos),
      recall: truePos / (truePos + falseNeg),
      accuracy: (trueNeg + truePos) / data.length
    })
  }
  return stats;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var beginTrain = Date.now();

var trainingStats = classifier.train(trainSet);

var beginTest = Date.now();

var testStats = classifier.<span class="apidocCodeKeywordSpan">test</span>(testSet);

var endTest = Date.now();

return {
  error : testStats.error,
  misclasses: testStats.misclasses,
  trainTime : beginTest - beginTrain,
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.toFunction" id="apidoc.module.brain.NeuralNetwork.prototype.toFunction">module brain.NeuralNetwork.prototype.toFunction</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.toFunction.toFunction" id="apidoc.element.brain.NeuralNetwork.prototype.toFunction.toFunction">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>toFunction
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toFunction = function () {
  var json = this.toJSON();
  // return standalone function that mimics run()
  return new Function(&#x22;input&#x22;,
&#x27;  var net = &#x27; + JSON.stringify(json) + &#x27;;\n\n\
for (var i = 1; i &#x3c; net.layers.length; i++) {\n\
  var layer = net.layers[i];\n\
  var output = {};\n\
  \n\
  for (var id in layer) {\n\
    var node = layer[id];\n\
    var sum = node.bias;\n\
    \n\
    for (var iid in node.weights) {\n\
      sum += node.weights[iid] * input[iid];\n\
    }\n\
    output[id] = (1 / (1 + Math.exp(-sum)));\n\
  }\n\
  input = output;\n\
}\n\
return output;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

net.fromJSON(json);
```

You can also get a custom standalone function from a trained network that acts just like `run()`:

```javascript
var run = net.<span class="apidocCodeKeywordSpan">toFunction</span>();

var output = run({ r: 1, g: 0.4, b: 0 });

console.log(run.toString()); // copy and paste! no need to import brain.js
```
## Streams
The network now has a [WriteStream](http://nodejs.org/api/stream.html#stream_class_stream_writable). You can train the network by
 using `pipe()` to send the training data to the network.
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.toJSON" id="apidoc.module.brain.NeuralNetwork.prototype.toJSON">module brain.NeuralNetwork.prototype.toJSON</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.toJSON.toJSON" id="apidoc.element.brain.NeuralNetwork.prototype.toJSON.toJSON">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>toJSON
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toJSON = function () {
<span class="apidocCodeCommentSpan">  /* make json look like:
    {
      layers: [
        { x: {},
          y: {}},
        {&#x27;0&#x27;: {bias: -0.98771313, weights: {x: 0.8374838, y: 1.245858},
         &#x27;1&#x27;: {bias: 3.48192004, weights: {x: 1.7825821, y: -2.67899}}},
        { f: {bias: 0.27205739, weights: {&#x27;0&#x27;: 1.3161821, &#x27;1&#x27;: 2.00436}}}
      ]
    }
  */
</span>  var layers = [];
  for (var layer = 0; layer &#x3c;= this.outputLayer; layer++) {
    layers[layer] = {};

    var nodes;
    // turn any internal arrays back into hashes for readable json
    if (layer == 0 &#x26;&#x26; this.inputLookup) {
      nodes = _(this.inputLookup).keys();
    }
    else if (layer == this.outputLayer &#x26;&#x26; this.outputLookup) {
      nodes = _(this.outputLookup).keys();
    }
    else {
      nodes = _.range(0, this.sizes[layer]);
    }

    for (var j = 0; j &#x3c; nodes.length; j++) {
      var node = nodes[j];
      layers[layer][node] = {};

      if (layer &#x3e; 0) {
        layers[layer][node].bias = this.biases[layer][j];
        layers[layer][node].weights = {};
        for (var k in layers[layer - 1]) {
          var index = k;
          if (layer == 1 &#x26;&#x26; this.inputLookup) {
            index = this.inputLookup[k];
          }
          layers[layer][node].weights[k] = this.weights[layer][j][index];
        }
      }
    }
  }
  return { layers: layers, outputLookup:!!this.outputLookup, inputLookup:!!this.inputLookup };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

If the training error is still something huge like `0.4` after 20000 iterations, it&#x27;s a good sign that the network can&#x27
;t make sense of the data you&#x27;re giving it.

## JSON
Serialize or load in the state of a trained network with JSON:

```javascript
var json = net.<span class="apidocCodeKeywordSpan">toJSON</span>();

net.fromJSON(json);
```

You can also get a custom standalone function from a trained network that acts just like `run()`:

```javascript
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.train" id="apidoc.module.brain.NeuralNetwork.prototype.train">module brain.NeuralNetwork.prototype.train</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.train.train" id="apidoc.element.brain.NeuralNetwork.prototype.train.train">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>train
        <span class="apidocSignatureSpan">(data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">train = function (data, options) {
  data = this.formatData(data);

  options = options || {};
  var iterations = options.iterations || 20000;
  var errorThresh = options.errorThresh || 0.005;
  var log = options.log || false;
  var logPeriod = options.logPeriod || 10;
  var learningRate = options.learningRate || this.learningRate || 0.3;
  var callback = options.callback;
  var callbackPeriod = options.callbackPeriod || 10;

  var inputSize = data[0].input.length;
  var outputSize = data[0].output.length;

  var hiddenSizes = this.hiddenSizes;
  if (!hiddenSizes) {
    hiddenSizes = [Math.max(3, Math.floor(inputSize / 2))];
  }
  var sizes = _([inputSize, hiddenSizes, outputSize]).flatten();
  this.initialize(sizes);

  var error = 1;
  for (var i = 0; i &#x3c; iterations &#x26;&#x26; error &#x3e; errorThresh; i++) {
    var sum = 0;
    for (var j = 0; j &#x3c; data.length; j++) {
      var err = this.trainPattern(data[j].input, data[j].output, learningRate);
      sum += err;
    }
    error = sum / data.length;

    if (log &#x26;&#x26; (i % logPeriod == 0)) {
      console.log(&#x22;iterations:&#x22;, i, &#x22;training error:&#x22;, error);
    }
    if (callback &#x26;&#x26; (i % callbackPeriod == 0)) {
      callback({ error: error, iterations: i });
    }
  }

  return {
    error: error,
    iterations: i
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

# brain
`brain` is a JavaScript [neural network](http://en.wikipedia.org/wiki/Artificial_neural_network) library. Here&#x27;s an example
 of using it to approximate the XOR function:

```javascript
var net = new brain.NeuralNetwork();

net.<span class="apidocCodeKeywordSpan">train</span>([{input: [0, 0], output: [0]},
           {input: [0, 1], output: [1]},
           {input: [1, 0], output: [1]},
           {input: [1, 1], output: [0]}]);

var output = net.run([1, 0]);  // [0.987]
```
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.NeuralNetwork.prototype.trainPattern" id="apidoc.module.brain.NeuralNetwork.prototype.trainPattern">module brain.NeuralNetwork.prototype.trainPattern</a></h1>


    <h2>
        <a href="#apidoc.element.brain.NeuralNetwork.prototype.trainPattern.trainPattern" id="apidoc.element.brain.NeuralNetwork.prototype.trainPattern.trainPattern">
        function <span class="apidocSignatureSpan">brain.NeuralNetwork.prototype.</span>trainPattern
        <span class="apidocSignatureSpan">(input, target, learningRate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">trainPattern = function (input, target, learningRate) {
  learningRate = learningRate || this.learningRate;

  // forward propogate
  this.runInput(input);

  // back propogate
  this.calculateDeltas(target);
  this.adjustWeights(learningRate);

  var error = mse(this.errors[this.outputLayer]);
  return error;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var sizes = _([inputSize, hiddenSizes, outputSize]).flatten();
this.initialize(sizes);

var error = 1;
for (var i = 0; i &#x3c; iterations &#x26;&#x26; error &#x3e; errorThresh; i++) {
  var sum = 0;
  for (var j = 0; j &#x3c; data.length; j++) {
    sum += this.<span class="apidocCodeKeywordSpan">trainPattern</span>(data[j].input, data[j].output);
  }
  error = sum / data.length;
}

return {
  error: error,
  iterations: i
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.crossValidate" id="apidoc.module.brain.crossValidate">module brain.crossValidate</a></h1>


    <h2>
        <a href="#apidoc.element.brain.crossValidate.crossValidate" id="apidoc.element.brain.crossValidate.crossValidate">
        function <span class="apidocSignatureSpan">brain.</span>crossValidate
        <span class="apidocSignatureSpan">(classifierConst, data, opts, trainOpts, k)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function crossValidate(classifierConst, data, opts, trainOpts, k) {
  k = k || 4;
  var size = data.length / k;

  data = _(data).sortBy(function() {
    return Math.random();
  });

  var avgs = {
    error : 0,
    trainTime : 0,
    testTime : 0,
    iterations: 0,
    trainError: 0
  };

  var stats = {
    truePos: 0,
    trueNeg: 0,
    falsePos: 0,
    falseNeg: 0,
    total: 0
  };

  var misclasses = [];

  var results = _.range(k).map(function(i) {
    var dclone = _(data).clone();
    var testSet = dclone.splice(i * size, size);
    var trainSet = dclone;

    var result = testPartition(classifierConst, opts, trainOpts, trainSet, testSet);

    _(avgs).each(function(sum, stat) {
      avgs[stat] = sum + result[stat];
    });

    _(stats).each(function(sum, stat) {
      stats[stat] = sum + result[stat];
    })

    misclasses.push(result.misclasses);

    return result;
  });

  _(avgs).each(function(sum, i) {
    avgs[i] = sum / k;
  });

  stats.precision = stats.truePos / (stats.truePos + stats.falsePos);
  stats.recall = stats.truePos / (stats.truePos + stats.falseNeg);
  stats.accuracy = (stats.trueNeg + stats.truePos) / stats.total;

  stats.testSize = size;
  stats.trainSize = data.length - size;

  return {
    avgs: avgs,
    stats: stats,
    sets: results,
    misclasses: _(misclasses).flatten()
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.lookup" id="apidoc.module.brain.lookup">module brain.lookup</a></h1>


    <h2>
        <a href="#apidoc.element.brain.lookup.buildLookup" id="apidoc.element.brain.lookup.buildLookup">
        function <span class="apidocSignatureSpan">brain.lookup.</span>buildLookup
        <span class="apidocSignatureSpan">(hashes)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function buildLookup(hashes) {
  // [{a: 1}, {b: 6, c: 7}] -&#x3e; {a: 0, b: 1, c: 2}
  var hash = _(hashes).reduce(function(memo, hash) {
    return _(memo).extend(hash);
  }, {});
  return lookupFromHash(hash);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
},

formatData: function(data) {
  // turn sparse hash input into arrays with 0s as filler
  if (!_(data[0].input).isArray()) {
    if (!this.inputLookup) {
      this.inputLookup = lookup.<span class="apidocCodeKeywordSpan">buildLookup</span>(_(data).pluck(&#x22;input&#x22;));
    }
    data = data.map(function(datum) {
      var array = lookup.toArray(this.inputLookup, datum.input)
      return {input: array, output: datum.output};
    }, this);
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.lookup.lookupFromArray" id="apidoc.element.brain.lookup.lookupFromArray">
        function <span class="apidocSignatureSpan">brain.lookup.</span>lookupFromArray
        <span class="apidocSignatureSpan">(array)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function lookupFromArray(array) {
  var lookup = {};
  // super fast loop
  var z = 0;
  var i = array.length;
  while (i-- &#x3e; 0) {
    lookup[array[i]] = z++;
  };
  return lookup;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
TrainStream.prototype.finishStreamIteration = function() {
  if (this.dataFormatDetermined &#x26;&#x26; this.size !== this.count) {
console.log(&#x22;This iteration&#x27;s data length was different from the first.&#x22;);
  }

  if (!this.dataFormatDetermined) {
// create the lookup
this.neuralNetwork.inputLookup = lookup.<span class="apidocCodeKeywordSpan">lookupFromArray</span>(this.inputKeys);
this.neuralNetwork.outputLookup = lookup.lookupFromArray(this.outputKeys);

var data = this.neuralNetwork.formatData(this.firstDatum);
var inputSize = data[0].input.length;
var outputSize = data[0].output.length;

var hiddenSizes = this.hiddenSizes;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.lookup.lookupFromHash" id="apidoc.element.brain.lookup.lookupFromHash">
        function <span class="apidocSignatureSpan">brain.lookup.</span>lookupFromHash
        <span class="apidocSignatureSpan">(hash)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function lookupFromHash(hash) {
  // {a: 6, b: 7} -&#x3e; {a: 0, b: 1}
  var lookup = {};
  var index = 0;
  for (var i in hash) {
    lookup[i] = index++;
  }
  return lookup;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.weights = new Array(size);
    this.biases = new Array(size);
    this.outputs = new Array(size);

    for (var i = 0; i &#x3c;= this.outputLayer; i++) {
var layer = json.layers[i];
if (i == 0 &#x26;&#x26; !layer[0]) {
  this.inputLookup = lookup.<span class="apidocCodeKeywordSpan">lookupFromHash</span>(layer);
}
else if (i == this.outputLayer &#x26;&#x26; !layer[0]) {
  this.outputLookup = lookup.lookupFromHash(layer);
}

var nodes = _(layer).keys();
this.sizes[i] = nodes.length;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.lookup.toArray" id="apidoc.element.brain.lookup.toArray">
        function <span class="apidocSignatureSpan">brain.lookup.</span>toArray
        <span class="apidocSignatureSpan">(lookup, hash)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function toArray(lookup, hash) {
  // {a: 0, b: 1}, {a: 6} -&#x3e; [6, 0]
  var array = [];
  for (var i in lookup) {
    array[lookup[i]] = hash[i] || 0;
  }
  return array;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
  }
}
  },

  run: function(input) {
if (this.inputLookup) {
  input = lookup.<span class="apidocCodeKeywordSpan">toArray</span>(this.inputLookup, input);
}

var output = this.runInput(input);

if (this.outputLookup) {
  output = lookup.toHash(this.outputLookup, output);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.brain.lookup.toHash" id="apidoc.element.brain.lookup.toHash">
        function <span class="apidocSignatureSpan">brain.lookup.</span>toHash
        <span class="apidocSignatureSpan">(lookup, array)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function toHash(lookup, array) {
  // {a: 0, b: 1}, [6, 7] -&#x3e; {a: 6, b: 7}
  var hash = {};
  for (var i in lookup) {
    hash[i] = array[lookup[i]];
  }
  return hash;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (this.inputLookup) {
    input = lookup.toArray(this.inputLookup, input);
  }

  var output = this.runInput(input);

  if (this.outputLookup) {
    output = lookup.<span class="apidocCodeKeywordSpan">toHash</span>(this.outputLookup, output);
  }
  return output;
},

runInput: function(input) {
  this.outputs[0] = input;  // set output state of input layer
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.brain.neuralnetwork" id="apidoc.module.brain.neuralnetwork">module brain.neuralnetwork</a></h1>


    <h2>
        <a href="#apidoc.element.brain.neuralnetwork.NeuralNetwork" id="apidoc.element.brain.neuralnetwork.NeuralNetwork">
        function <span class="apidocSignatureSpan">brain.neuralnetwork.</span>NeuralNetwork
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">NeuralNetwork = function (options) {
  options = options || {};
  this.learningRate = options.learningRate || 0.3;
  this.momentum = options.momentum || 0.1;
  this.hiddenSizes = options.hiddenLayers;

  this.binaryThresh = options.binaryThresh || 0.5;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



# brain
`brain` is a JavaScript [neural network](http://en.wikipedia.org/wiki/Artificial_neural_network) library. Here&#x27;s an example
 of using it to approximate the XOR function:

```javascript
var net = new brain.<span class="apidocCodeKeywordSpan">NeuralNetwork</span>();

net.train([{input: [0, 0], output: [0]},
           {input: [0, 1], output: [1]},
           {input: [1, 0], output: [1]},
           {input: [1, 1], output: [0]}]);

var output = net.run([1, 0]);  // [0.987]
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
